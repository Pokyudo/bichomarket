<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Precios de Bonos y LECAP</title>
  <style>
    body {
      background-color: #0d1117;
      color: #c9d1d9;
      font-family: monospace;
      padding: 20px;
      margin: 0;
    }

    h1, h2 {
      color: #58a6ff;
      font-size: 22px;
      margin-top: 40px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
      margin-bottom: 40px;
    }

    th, td {
      border: 1px solid #30363d;
      padding: 6px 8px;
      text-align: center;
    }

    th {
      background-color: #161b22;
      color: #d2d2d2;
    }

    td.green {
      color: #28f028;
    }

    td.red {
      color: #f04747;
    }

    td.gray {
      color: #8b949e;
    }

    tr:hover {
      background-color: #21262d;
    }
  </style>
</head>
<body>

  //<h1>Bonos Argentina</h1>
  //<table id="tablaBonos"></table>

  <h2>LECAP y Letras del Tesoro</h2>
  <table id="tablaLecap"></table>

  <script>
    // Bonos (hoja 1)
    < !--
    //const bonosCsvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRJBZwnLZa0t8RMRWp5GnmpWmV8PUyrO81CJoxRP1k4Y3OYxEF007tEalItapgpGFj1Pt_KN_PFTuFe/pub?gid=0&single=true&output=csv";
-->
    // LECAP (hoja 2)
    const lecapCsvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRJBZwnLZa0t8RMRWp5GnmpWmV8PUyrO81CJoxRP1k4Y3OYxEF007tEalItapgpGFj1Pt_KN_PFTuFe/pub?gid=809820325&single=true&output=csv";
< !--
    //fetch(bonosCsvUrl)
    //  .then(response => response.text())
    //  .then(csv => renderTable(csv, "tablaBonos", "pct_change"));
-->
    fetch(lecapCsvUrl)
      .then(response => response.text())
      .then(csv => renderTable(csv, "tablaLecap", "var%"));

    function renderTable(csv, tableId, columnToColor) {
      const lines = csv.trim().split("\n").map(line => line.split(","));
      const table = document.getElementById(tableId);
      let currentColorIndex = -1;

      lines.forEach((row, rowIndex) => {
        const tr = document.createElement("tr");

        const isHeader = row.some(cell => cell.toLowerCase().trim() === columnToColor.toLowerCase());
        if (isHeader) {
          currentColorIndex = row.findIndex(cell => cell.toLowerCase().trim() === columnToColor.toLowerCase());
        }

        row.forEach((cell, colIndex) => {
          const element = document.createElement(isHeader ? "th" : "td");
          const cleanCell = cell.trim();

          if (!isHeader && colIndex === currentColorIndex) {
            const num = parseFloat(cleanCell.replace("%", "").replace(",", "."));
            if (!isNaN(num)) {
              element.className = num > 0 ? "green" : num < 0 ? "red" : "gray";
              element.textContent = num.toFixed(2) + "%";
            } else {
              element.textContent = cleanCell;
            }
          } else {
            element.textContent = cleanCell;
          }

          tr.appendChild(element);
        });

        table.appendChild(tr);
      });
    }
  </script>

</body>
</html>
